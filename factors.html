<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Factors & Multiples</title>
<style>
  :root { --bg:#f6f7fb; --card:#ffffff; --ink:#1f2a44; --muted:#6b7280; --good:#1f8b4c; --bad:#b00020; --brand:#8b5cf6;}
  * { box-sizing: border-box; }
  body { margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; color:var(--ink); background: linear-gradient(180deg,#f3e8ff, #f6f7fb 220px);}
  .wrap { max-width: 900px; margin: 32px auto; padding: 0 16px; }
  header { display:flex; gap:12px; align-items:center; justify-content:space-between; margin-bottom:16px;}
  h1 { font-size: clamp(22px, 4vw, 30px); margin:0; }
  .lang { display:flex; gap:10px; align-items:center; }
  .toggle { border:1px solid #d1d5db; background:#fff; padding:6px 10px; border-radius:10px; cursor:pointer; }
  .card { background:var(--card); border-radius:14px; box-shadow:0 8px 24px rgba(31,42,68,.08); padding:18px; }
  .hud { display:flex; gap:12px; flex-wrap:wrap; align-items:center; color:var(--muted); font-weight:600; }
  .badge { background:#eef2ff; color:#3730a3; padding:6px 10px; border-radius:999px; }
  .question { font-size: clamp(22px, 4.5vw, 34px); text-align:center; margin:10px 0 0; }
  .answerrow { display:flex; gap:10px; justify-content:center; align-items:center; margin-top:8px; flex-wrap:wrap; }
  input[type="number"] { width:180px; padding:10px 12px; border:1px solid #d1d5db; border-radius:10px; font-size:18px; }
  .btn { background:var(--brand); color:white; border:none; border-radius:10px; padding:10px 14px; font-size:16px; cursor:pointer; }
  .btn.secondary { background:#e5e7eb; color:#111827; }
  .feedback { min-height:28px; text-align:center; font-weight:700; margin-top:10px; }
  .good { color:var(--good); } .bad { color:var(--bad); }
  .hint { color:var(--muted); text-align:center; margin-top:4px; font-size:14px; }
  a.home { text-decoration:none; color:#4b5563; font-weight:700; }
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1 id="title">Factors & Multiples</h1>
      <div class="lang">
        <a class="home" href="./index.html">‚Üê Home</a>
        <span id="langLabel">Language:</span>
        <button class="toggle" id="langToggle" type="button">ES</button>
      </div>
    </header>

    <div class="hud">
      <span class="badge" id="badgeBest">Best: <span id="bestScore">0</span></span>
      <span class="badge" id="badgeStreak">Streak: <span id="streak">0</span></span>
      <span class="badge" id="badgeScore">Score: <span id="score">0</span></span>
      <span class="badge" id="roundBadge">Q: <span id="qIndex">0</span>/10</span>
    </div>

    <div class="card" style="margin-top:12px;">
      <div class="question" id="question">Press Start to begin a 10-question round.</div>
      <div class="answerrow">
        <input type="number" id="answer" placeholder="Your answer" />
        <button class="btn" id="check" type="button">Check</button>
        <button class="btn secondary" id="next" type="button">Skip</button>
        <button class="btn" id="start" type="button">Start (10)</button>
      </div>
      <div class="feedback" id="feedback"></div>
      <div class="hint" id="hint"></div>
    </div>
  </div>

<script>
document.addEventListener("DOMContentLoaded", () => {
  // ---- i18n ----
  const STR = {
    en: {
      title: "Factors & Multiples",
      language: "Language:",
      start: "Start (10)",
      check: "Check",
      skip: "Skip",
      best: "Best",
      streak: "Streak",
      score: "Score",
      roundDone: s => `üèÅ Round finished! Score: ${s}/10`,
      correct: "‚úÖ Correct!",
      wrong: "‚ùå Not quite.",
      q_gcd: (a,b)=> `What is the GCF (greatest common factor) of ${a} and ${b}?`,
      q_lcm: (a,b)=> `What is the LCM (least common multiple) of ${a} and ${b}?`,
      hint_gcd: (a,b,f)=> `Hint: common factors of ${a} & ${b}: ${f.join(" ‚Ä¢ ")}`,
      hint_lcm: (a,b)=> `Hint: lcm √ó gcf = ${a}√ó${b} = ${a*b}; try lcm = ${(a*b)}/gcf`
    },
    es: {
      title: "Factores y M√∫ltiplos",
      language: "Idioma:",
      start: "Empezar (10)",
      check: "Comprobar",
      skip: "Saltar",
      best: "Mejor",
      streak: "Racha",
      score: "Puntos",
      roundDone: s => `üèÅ ¬°Ronda terminada! Puntuaci√≥n: ${s}/10`,
      correct: "‚úÖ ¬°Correcto!",
      wrong: "‚ùå No es del todo.",
      q_gcd: (a,b)=> `¬øCu√°l es el MCD (m√°ximo com√∫n divisor) de ${a} y ${b}?`,
      q_lcm: (a,b)=> `¬øCu√°l es el MCM (m√≠nimo com√∫n m√∫ltiplo) de ${a} y ${b}?`,
      hint_gcd: (a,b,f)=> `Pista: factores comunes de ${a} y ${b}: ${f.join(" ‚Ä¢ ")}`,
      hint_lcm: (a,b,l)=> `Pista: mcm √ó mcd = ${a}√ó${b} = ${a*b}; prueba mcm = ${(a*b)}/mcd`
    }
  };
  let lang = localStorage.getItem("tta_lang") || "en";
  const T = (k,...p)=> typeof STR[lang][k]==="function" ? STR[lang][k](...p) : STR[lang][k];

  // ---- element helpers ----
  const $ = s => document.querySelector(s);
  const title = $("#title"), langLabel=$("#langLabel"), langToggle=$("#langToggle");
  const bestScore=$("#bestScore"), streakEl=$("#streak"), scoreEl=$("#score"), qIndexEl=$("#qIndex");
  const question=$("#question"), answer=$("#answer"), checkBtn=$("#check"), nextBtn=$("#next"), startBtn=$("#start");
  const feedback=$("#feedback"), hint=$("#hint");

  if(!title || !startBtn){ console.error("DOM not ready"); return; }

  // ---- state ----
  let score=0, streak=0, best=0, qIndex=0, mode="idle";
  const STORAGE_KEY="factors_progress_v1";

  const factors = n => Array.from({length:n},(_,i)=>i+1).filter(k=>n%k===0);
  const gcd = (a,b)=> b? gcd(b,a%b):a;
  const lcm = (a,b)=> a/gcd(a,b)*b;

  let qa=null; // {type,a,b,answer}

  function applyLang(){
    document.documentElement.lang = lang;
    title.textContent = T("title");
    langLabel.textContent = T("language");
    startBtn.textContent = T("start");
    checkBtn.textContent = T("check");
    nextBtn.textContent = T("skip");
    // update HUD labels
    // (text before the number inside badges)
    document.querySelector("#badgeBest").childNodes[0].textContent = T("best")+": ";
    document.querySelector("#badgeStreak").childNodes[0].textContent = T("streak")+": ";
    document.querySelector("#badgeScore").childNodes[0].textContent = T("score")+": ";
    langToggle.textContent = lang==="en" ? "ES" : "EN";
  }

  // load progress
  (function(){
    const d=JSON.parse(localStorage.getItem(STORAGE_KEY)||"{}");
    if(d.best) best=d.best;
    bestScore.textContent = best;
    applyLang();
  })();

  function newNumbers(){
    const pool=[6,8,9,10,12,14,15,16,18,20,21,24,27,28,30,32,36,40,42,45,48,54,56,60];
    const a = pool[Math.floor(Math.random()*pool.length)];
    const b = pool[Math.floor(Math.random()*pool.length)];
    return [a,b];
  }

  function makeQuestion(){
    c
